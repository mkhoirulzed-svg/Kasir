<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Struk</title>

<style>
    body { margin:0; padding:0; background:#fff; }
    .receipt {
        width: 58mm;
        padding: 10px;
        margin: auto;
        font-family: monospace;
        font-size: 12px;
    }
    .center { text-align:center; }
    .divider { border-top:1px dashed #000; margin:6px 0; }
    .right { text-align:right; }
    .btn-wa {
        background:#25D366;
        color:#fff;
        padding:8px 12px;
        border:none;
        border-radius:5px;
        margin:10px;
        width:calc(100% - 20px);
        font-size:14px;
        cursor:pointer;
    }
</style>

<script src="funprint.js"></script>
</head>

<body>

<div class="receipt" id="strukArea">
    <div class="center">
        <img src="logo.png" width="50"><br>
        <strong>Alkes PKY</strong><br>
        Toko alat kesehatan Palangkaraya<br>
    </div>

    <div class="divider"></div>

    <div id="itemList"></div>

    <div class="divider"></div>

    Total: <span id="total" class="right"></span>

    <div class="divider"></div>

    <div class="center">Terima kasih sudah berbelanja!<br>
    Sehat selalu<br></div>
</div>

<!-- Tombol Kirim WA -->
<button class="btn-wa" onclick="kirimWA()">Kirim via WhatsApp</button>

<script>
// ========================
// LOAD DATA
// ========================
let data = JSON.parse(localStorage.getItem("strukData") || "[]");

let html = "";
let total = 0;

data.forEach(b => {
    let sub = b.qty * b.harga;
    total += sub;

    html += `
        ${b.nama}<br>
        ${b.qty} x ${b.harga.toLocaleString()}  
        <span style="float:right">${sub.toLocaleString()}</span><br>
    `;
});

document.getElementById("itemList").innerHTML = html;
document.getElementById("total").innerText = "Rp " + total.toLocaleString();

// ========================
// CETAK VIA FUNPRINT
// ========================
setTimeout(() => {
    let content = document.getElementById("strukArea").innerText;
    sendToFunPrint(content);
}, 800);


// ========================
// KIRIM WA (TEKS)
// ========================
function kirimWA() {
    let content = document.getElementById("strukArea").innerText;
    let encoded = encodeURIComponent(content);

    // buka WhatsApp
    window.open("https://wa.me/?text=" + encoded, "_blank");
}
</script>

</body>
</html>
